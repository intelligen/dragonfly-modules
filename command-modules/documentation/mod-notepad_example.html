<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Command-module example of MappingRule use &mdash; Dragonfly-modules v0.1 documentation</title>
    <link rel="stylesheet" href="_static/default.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
          URL_ROOT:    '',
          VERSION:     '0.1',
          COLLAPSE_MODINDEX: false,
          FILE_SUFFIX: '.html'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="contents" title="Global table of contents" href="contents.html" />
    <link rel="index" title="Global index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="top" title="Dragonfly-modules v0.1 documentation" href="index.html" />
    <link rel="prev" title="Command-module example of CompoundRule use" href="mod-notepad_foodgroups.html" />
  </head>
  <body>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="mod-notepad_foodgroups.html" title="Command-module example of CompoundRule use"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Dragonfly-modules v0.1 documentation</a> &raquo;</li>
      </ul>
    </div>
    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body">
            
  
  <div class="section" id="command-module-example-of-mappingrule-use">
<h1>Command-module example of <strong>MappingRule</strong> use<a class="headerlink" href="#command-module-example-of-mappingrule-use" title="Permalink to this headline">¶</a></h1>
<p>This module is a simple example of Dragonfly use.  It
implements several keyboard shortcuts for controlling
notepad.  This module is a demonstration of the Dragonfly
library.</p>
<div class="section" id="grammars-contexts-and-rules">
<h2>Grammars, Contexts, and Rules<a class="headerlink" href="#grammars-contexts-and-rules" title="Permalink to this headline">¶</a></h2>
<p>Several key concepts of the Dragonfly library are used
in this module.</p>
<dl class="docutils">
<dt><em>Grammars</em></dt>
<dd><p class="first">Grammars are very important in Dragonfly.  They take
care of the communication between a command-module and
NaturallySpeaking&#8217;s recognition engine.</p>
<p class="last">A grammar is in essence a collection of rules.  It
contains the rules, loads them into NaturallySpeaking,
activates them according to the context, and manages
that they process the results of a recognition.</p>
</dd>
<dt><em>Contexts</em></dt>
<dd>Contexts determined when grammars and rules are
active.  The commands in this module are for notepad,
and the grammar is therefore created with an
application context <tt class="docutils literal"><span class="pre">AppContext</span></tt> that is only
active when notepad is in the foreground.</dd>
<dt><em>Rules</em></dt>
<dd><p class="first">Rules define what can actually be said.  They can be
thought of as distinct command utterances.  Rules are
built up out of elements, and can form fairly complex
structures.  See the Dragonfly documentation for more
details on this topic.</p>
<p class="last">This module uses a mapping rule <tt class="docutils literal"><span class="pre">MappingRule</span></tt> which
maps spoken-forms to Dragonfly actions, namely
keystrokes.  This is a common pattern, and the mapping
rule takes care of most implementation details.</p>
</dd>
</dl>
</div>
<div class="section" id="module-source-code">
<h2>Module source code<a class="headerlink" href="#module-source-code" title="Permalink to this headline">¶</a></h2>
<table class="highlighttable"><tr><td class="linenos"><pre>  1
  2
  3
  4
  5
  6
  7
  8
  9
 10
 11
 12
 13
 14
 15
 16
 17
 18
 19
 20
 21
 22
 23
 24
 25
 26
 27
 28
 29
 30
 31
 32
 33
 34
 35
 36
 37
 38
 39
 40
 41
 42
 43
 44
 45
 46
 47
 48
 49
 50
 51
 52
 53
 54
 55
 56
 57
 58
 59
 60
 61
 62
 63
 64
 65
 66
 67
 68
 69
 70
 71
 72
 73
 74
 75
 76
 77
 78
 79
 80
 81
 82
 83
 84
 85
 86
 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101</pre></td><td class="code"><div class="highlight"><pre><span class="c">#</span>
<span class="c"># This file is a command-module for Dragonfly.</span>
<span class="c"># (c) Copyright 2008 by Christo Butcher</span>
<span class="c"># Licensed under the LGPL, see &lt;http://www.gnu.org/licenses/&gt;</span>
<span class="c">#</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">Command-module example of **MappingRule** use</span>
<span class="sd">=============================================</span>
<span class="sd">This module is a simple example of Dragonfly use.  It</span>
<span class="sd">implements several keyboard shortcuts for controlling</span>
<span class="sd">notepad.  This module is a demonstration of the Dragonfly</span>
<span class="sd">library.</span>

<span class="sd">Grammars, Contexts, and Rules</span>
<span class="sd">-----------------------------</span>
<span class="sd">Several key concepts of the Dragonfly library are used</span>
<span class="sd">in this module.</span>

<span class="sd">*Grammars*</span>
<span class="sd">    Grammars are very important in Dragonfly.  They take</span>
<span class="sd">    care of the communication between a command-module and</span>
<span class="sd">    NaturallySpeaking&#39;s recognition engine.</span>

<span class="sd">    A grammar is in essence a collection of rules.  It</span>
<span class="sd">    contains the rules, loads them into NaturallySpeaking,</span>
<span class="sd">    activates them according to the context, and manages</span>
<span class="sd">    that they process the results of a recognition.</span>

<span class="sd">*Contexts*</span>
<span class="sd">    Contexts determined when grammars and rules are</span>
<span class="sd">    active.  The commands in this module are for notepad,</span>
<span class="sd">    and the grammar is therefore created with an</span>
<span class="sd">    application context ``AppContext`` that is only</span>
<span class="sd">    active when notepad is in the foreground.</span>

<span class="sd">*Rules*</span>
<span class="sd">    Rules define what can actually be said.  They can be</span>
<span class="sd">    thought of as distinct command utterances.  Rules are</span>
<span class="sd">    built up out of elements, and can form fairly complex</span>
<span class="sd">    structures.  See the Dragonfly documentation for more</span>
<span class="sd">    details on this topic.</span>

<span class="sd">    This module uses a mapping rule ``MappingRule`` which</span>
<span class="sd">    maps spoken-forms to Dragonfly actions, namely</span>
<span class="sd">    keystrokes.  This is a common pattern, and the mapping</span>
<span class="sd">    rule takes care of most implementation details.</span>

<span class="sd">&quot;&quot;&quot;</span>


<span class="kn">from</span> <span class="nn">dragonfly.grammar.grammar</span>     <span class="kn">import</span> <span class="n">Grammar</span>
<span class="kn">from</span> <span class="nn">dragonfly.grammar.context</span>     <span class="kn">import</span> <span class="n">AppContext</span>
<span class="kn">from</span> <span class="nn">dragonfly.grammar.mappingrule</span> <span class="kn">import</span> <span class="n">MappingRule</span>
<span class="kn">from</span> <span class="nn">dragonfly.grammar.elements</span>    <span class="kn">import</span> <span class="n">Dictation</span>
<span class="kn">from</span> <span class="nn">dragonfly.actions.actions</span>     <span class="kn">import</span> <span class="n">Key</span><span class="p">,</span> <span class="n">Text</span>


<span class="c">#---------------------------------------------------------------------------</span>
<span class="c"># Create this module&#39;s grammar and the context under which it&#39;ll be active.</span>

<span class="n">grammar_context</span> <span class="o">=</span> <span class="n">AppContext</span><span class="p">(</span><span class="n">executable</span><span class="o">=</span><span class="s">&quot;notepad&quot;</span><span class="p">)</span>
<span class="n">grammar</span> <span class="o">=</span> <span class="n">Grammar</span><span class="p">(</span><span class="s">&quot;notepad_example&quot;</span><span class="p">,</span> <span class="n">context</span><span class="o">=</span><span class="n">grammar_context</span><span class="p">)</span>


<span class="c">#---------------------------------------------------------------------------</span>
<span class="c"># Create a mapping rule which maps things you can say to actions.</span>
<span class="c">#</span>
<span class="c"># Note the relationship between the *mapping* and *extras* keyword</span>
<span class="c">#  arguments.  The extras is a list of Dragonfly elements which are</span>
<span class="c">#  available to be used in the specs of the mapping.  In this example</span>
<span class="c">#  the Dictation(&quot;text&quot;)* extra makes it possible to use &quot;&lt;text&gt;&quot;</span>
<span class="c">#  within a mapping spec and &quot;%(text)s&quot; within the associated action.</span>

<span class="n">example_rule</span> <span class="o">=</span> <span class="n">MappingRule</span><span class="p">(</span>
    <span class="n">name</span><span class="o">=</span><span class="s">&quot;example&quot;</span><span class="p">,</span>    <span class="c"># The name of the rule.</span>
    <span class="n">mapping</span><span class="o">=</span><span class="p">{</span>          <span class="c"># The mapping dict: spec -&gt; action.</span>
             <span class="s">&quot;save [file]&quot;</span><span class="p">:</span>            <span class="n">Key</span><span class="p">(</span><span class="s">&quot;c-s&quot;</span><span class="p">),</span>
             <span class="s">&quot;save [file] as&quot;</span><span class="p">:</span>         <span class="n">Key</span><span class="p">(</span><span class="s">&quot;a-f, a&quot;</span><span class="p">),</span>
             <span class="s">&quot;save [file] as &lt;text&gt;&quot;</span><span class="p">:</span>  <span class="n">Key</span><span class="p">(</span><span class="s">&quot;a-f, a/20&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(text)s</span><span class="s">&quot;</span><span class="p">),</span>
             <span class="s">&quot;find &lt;text&gt;&quot;</span><span class="p">:</span>            <span class="n">Key</span><span class="p">(</span><span class="s">&quot;c-f/20&quot;</span><span class="p">)</span> <span class="o">+</span> <span class="n">Text</span><span class="p">(</span><span class="s">&quot;</span><span class="si">%(text)s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">),</span>
            <span class="p">},</span>
    <span class="n">extras</span><span class="o">=</span><span class="p">[</span>           <span class="c"># Special elements in the specs of the mapping.</span>
            <span class="n">Dictation</span><span class="p">(</span><span class="s">&quot;text&quot;</span><span class="p">),</span>
           <span class="p">],</span>
    <span class="p">)</span>

<span class="c"># Add the action rule to the grammar instance.</span>
<span class="n">grammar</span><span class="o">.</span><span class="n">add_rule</span><span class="p">(</span><span class="n">example_rule</span><span class="p">)</span>


<span class="c">#---------------------------------------------------------------------------</span>
<span class="c"># Load the grammar instance and define how to unload it.</span>

<span class="n">grammar</span><span class="o">.</span><span class="n">load</span><span class="p">()</span>

<span class="c"># Unload function which will be called by natlink at unload time.</span>
<span class="k">def</span> <span class="nf">unload</span><span class="p">():</span>
    <span class="k">global</span> <span class="n">grammar</span>
    <span class="k">if</span> <span class="n">grammar</span><span class="p">:</span> <span class="n">grammar</span><span class="o">.</span><span class="n">unload</span><span class="p">()</span>
    <span class="n">grammar</span> <span class="o">=</span> <span class="bp">None</span>
</pre></div>
</td></tr></table></div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3>Table Of Contents</h3>
            <ul>
<li><a class="reference external" href="">Command-module example of <strong>MappingRule</strong> use</a><ul>
<li><a class="reference external" href="#grammars-contexts-and-rules">Grammars, Contexts, and Rules</a></li>
<li><a class="reference external" href="#module-source-code">Module source code</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="mod-notepad_foodgroups.html" title="previous chapter">Command-module example of <strong>CompoundRule</strong> use</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="_sources/mod-notepad_example.txt">Show Source</a></li>
            </ul>
            <h3>Quick search</h3>
            <form class="search" action="search.html" method="get">
              <input type="text" name="q" size="18" /> <input type="submit" value="Go" />
              <input type="hidden" name="check_keywords" value="yes" />
              <input type="hidden" name="area" value="default" />
            </form>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="modindex.html" title="Global Module Index"
             accesskey="M">modules</a> |</li>
        <li class="right" >
          <a href="mod-notepad_foodgroups.html" title="Command-module example of CompoundRule use"
             accesskey="P">previous</a> |</li>
        <li><a href="index.html">Dragonfly-modules v0.1 documentation</a> &raquo;</li>
      </ul>
    </div>
    <div class="footer">
      &copy; Copyright 2008, Christo Butcher.
      Last updated on Nov 01, 2008.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a>.
    </div>
  </body>
</html>